<project xmlns:modello="modello" xmlns:ant="jelly:ant" xmlns:maven="jelly:maven" xmlns:j="jelly:core">

  <preGoal name="java:compile">
    <attainGoal name="modello:modello"/>
    <!-- Need the original package as well -->
    <ant:copy tofile="${basedir}/target/maven.mdo.m1" file="${maven.modello.model}" />
    <ant:replace file="${basedir}/target/maven.mdo.m1" token="org.apache.maven.model" value="org.apache.maven.project" />
    <maven:set plugin="maven-modello-plugin" property="maven.modello.model" value="${basedir}/target/maven.mdo.m1"/>
    <attainGoal name="modello:modello"/>
  </preGoal>

  <!-- We need to have the generated code before to compute the javadoc -->
  <preGoal name="maven-javadoc-plugin:register">
    <attainGoal name="modello:modello"/>
    <!-- Need the original package as well -->
    <ant:copy tofile="${basedir}/target/maven.mdo.m1" file="${maven.modello.model}" />
    <ant:replace file="${basedir}/target/maven.mdo.m1" token="org.apache.maven.model" value="org.apache.maven.project" />
    <maven:set plugin="maven-modello-plugin" property="maven.modello.model" value="${basedir}/target/maven.mdo.m1"/>
    <attainGoal name="modello:modello"/>
  </preGoal>

</project>